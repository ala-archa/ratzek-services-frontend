<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Как создавался интернет на хижине Рацека</title>
        <link rel="stylesheet" href="./css/style.css" />
    </head>
    <body>
        <div class="container">
            <div class="wrapper">
                <h2>О проекте (от Евгения Лепихина)</h2>
                <p>
                    Однажды СВОшным летом 2022 года нас (Святослав Деев и Евгений Лепихин) подвозил в Ала-Арчу какой-то мужик.
                    В процессе разговоров выяснилось, что он директор Кыргызгидметеоцентра. Вспомнили, что рядом с хижиной
                    Рацека находится какая-то метеостанция. Возник резонный вопрос: "а как вы оттуда передаете данные?". Оказалось,
                    что там ловит местный Мегаком. Дальнейшие полевые исследования показали, что судя по всему метеостанция
                    давно не работает. Но сам факт самой возможности организации связи прямо около хижины сильно меня заинтриговал.
                </p>
                <p>
                    Купил тарелку Mikrotik LHG, поставил на телефон разный софт, позволяющий получать с GSM-приемника сырую телеметрию.
                    Долго и мучительно бегал по морене туда-сюда. Тарелка упорно показывала ноль, иногда демонстрируя какой-то остаточный
                    сигнал на уровне потери. Зато телефон в одном месте показал аж целых две палки и -82 dBm. Правда, ни звонков, ни тем более хотя бы 2G 
                    выжать никак не удавалось.
                </p>
                <p>
                    Ладно. Известно, что антенны типа тарелок не дружат с отраженным сигналом — а прямой видимости на морене конечно же нет.
                    Купил антенну подешевле, зато секторную. Опять ноль. Зато на старой вертолетке, прямо над каменной хижиной, поймал аж 3G,
                    однако сколько бы я ни крутился — скорость выше 30Kbit/s выжать не получалось. Такая скорость в современных реалиях подойдет
                    для неспешной (десятки секнуд) отправки текстовых сообщений в Telagram, и очень медленной (минуты) загрузки простых сайтов.
                    Но такое людям предлагать стыдно.
                </p>
                <p>
                    И вот Вася Царевский одновременно с моими коллегами предложили организовать радиомост со "звонилки". Спаял мобильное питание
                    для тарелки и wifi-точки доступа. Сходил с этим барахлом на звонилку. Чуть не лишившись пальцев от морозов декабря, особо не целясь
                    поймал 6.5Mbit на вход и 3Mbit на выход. Это победа! Но — на звонилке нет электричества, да и радиомост стоит денег.
                </p>
                <p>
                    Дальше начались изыскания по возникшим проблемам. Перед нами стояли задачи:
                    <ul>
                        <li>Организация радиомоста. Никто из нас не является сетевым инженером, пришлось разбираться с нуля.</li>
                        <li>Питание для радиомоста. Вася, будучи электронщиком, активно подключился к решению проблемы.</li>
                        <li>Канал всё равно слабый, и любой подключившийся завалит его какими-нибудь торрентами. Этой задачей занялся я. Поставил себе задачу сделать сервис, бесплатный для всех, справедливо делящий полосу, предоставляющий локальные сервисы (видео, гайдбуки, книги, форум и т.д.)</li>
                        <li>Для локальных сервисов и организации удобного доступа в интернет нужен был красивый локальный сайт. Им занялся Святослав</li>
                    </ul>
                </p>
                <p>
                    На решение этих задач у нас ушли осень и вся зима.
                    Я напрограммировал всяких сервисов, <a href="https://github.com/ala-archa/ratzek-services-ansible">автоматизировал</a> их разворачивание. Создал <a href="https://github.com/ala-archa/ratzek-services-http-backend">бэкенд</a>, управляющий доступом в интернет.
                    Вася активно консультировал по солнечной панели, питанию, и спаял аж целый контроллер на <a href="https://github.com/ala-archa/solar-panel-controller">Arduino</a>.
                    Святослав сделал фронтенд <a href="https://github.com/ala-archa/ratzek-services-frontend">для captive portal и вообще главную страницу</a>.
                </p>
                <p>
                    Дальше случился интересный диалог с Денисом Ваулиным. Он пояснил нельзя просто так взять и поставить и закрепить солнечную панель на камнях.
                    Проблема подкралась с неожиданной стороны: солнечная панель нагревается на солнце, а горные козлы любят тепло. А ещё они любят чесать рога.
                    Поэтому настоятельно рекомендовано было поднять оборудование над землей. И тут к нашему проекту неожиданно присоединился Дима Павленко,
                    который взял на себя строительство стойки для солнечной панели на звонилке и здорово помог с транспортировкой негабаритного груза.
                    Кроме того, была проблема оседания снега, но Вася посчитал, что зимой панель надо ставить под углом 58 градусов: это даст меньше энергии летом, но
                    куда более эффективно зимой, когда световой день очень короткий.
                </p>
                <p>
                    Наверх пришлось занести порядка 30 килограмм негабаритного груза. Этим занялись мы вдвоем с Васей. С монтажом на месте помог Дима Доброхотов, который случайно
                    оказался в нужном месте в нужное время с кримпером в руках.
                <p>
                    Планы дальше? Сейчас у нас ретранслятор работает исключительно на солнечной энергии. Иначе говоря, ночью интернета нет.
                    В планах поставить туда вторую панель. блок аккумуляторов и контроллер заряда. Тогда у нас будет интернет круглосуточно.
                    Очень ориентировочная стоимость оборудования для идеи — 40 тысяч сом.
                </p>
                <h2>Использованное оборудование</h2>
                <p>
                    Для проекта было куплено оборудование:
                    <ul>
                        <li>Mikrotik LHG6 kit — приемная тарелка.</li>
                        <li>Mikrotik SXTsq Lite5 2 шт. — радиомост</li>
                        <li>Солнечная панель SM 100-12 P (100Вт, Поликристалл)</li>
                        <li>Arduino nano, DC-DC модуль, конденсаторы высокой емкости, рассыпуха радиодеталей — контроллер питания на звонилке</li>
                        <li>Rapberry Pi 4 — локальные сервисы в хижине, контроль трафика</li>
                        <li>Какая-то USB Wi-fi сетевая карта с внешней антенной — раздача интернета насколько возможно широко</li>
                        <li>SSD диск на 256GB — более надежный и быстрый по сравнению с MicroSD способ хранения данных, который также служит главным диском для RPI</li>
                        <li>BMP280 — датчик температуры, давления и влажности</li>
                        <li>Куча бруса, проводов, гофры, уголки для монтажа</li>
                    </ul>
                    Кроме этого, для экспериментов и изысканий на местности пришлось купить секторную MIMO антенну, LTE-модем, пару DC-DC модулей, wifi-точку доступа.
                </p>
                <h2>Софт под капотом</h2>
                <p>
                    Все исходники можно найти в нашей группе проектов <a href="https://github.com/ala-archa">на Github</a>. Если говорить подробнее:
                    <ul>
                        <li>Rasbian OS — использованная операционная система на Raspberry PI</li>
                        <li>ipset, iptables, dhcpd, hostapd, bind — раздача интернета, управление сетевым трафиком</li>
                        <li>самописный бэкенд и фронтенд для управления captive порталом</li>
                        <li>Lemmy — блог</li>
                        <li>MiniDLNA — раздача медиа-файлов для тех плееров, которые умеют DLNA</li>
                        <li>Самописные системы зеркалирования прогноза погоды, гайдбуков. Основаны на httrack и yt-dl</li>
                        <li>Ansible — система разворачивания сервисов на Raspberry PI</li>
                        <li>Grafana — отображение красивых графиков по данным погоды, а также мониторинг внутреннего состояния систем</li>
                        <li>bsbmp-exporter — поставка данных с датчика метеостанции в систему</li>
                        <li>mikrotik-exporter — поставка данных с антенн в систему</li>
                        <li>openvpn — возможость администрирования всей системой с большой земли</li>
                    </ul>
                </p>
                <h3>Поблагодарить</h3>
                <div class="attention">
                    <p>
                        Будем благодарны за частичную компенсацию расходов.
                        <a class="otherlink" href="/donate.html">Здесь</a> описаны способы перевода донатов. В возможность появления здесь
                        интернета было вложено порядка 350 человеко-часов работы и около 60.000 сом в ценах 2022-2023 годов. Ежемесячно сотовому
                        оператору мы оплачиваем более 1000 сом.
                    </p>
                </div>
                <div class="buttonBox">
                    <a class="buttonAccessGranted" href="/donate.html">
                        Поблагодарить — жми!
                    </a>
                </div>
                <h3>Вход и статистика</h3>
                <div class="buttonBox">
                    <button disabled id="ap-control" class="buttonNoAccess" onClick="click">
                        ...
                    </button>
                </div>
            </div>
        </div>
        <script src="./js/main.js"></script>
    </body>
</html>
